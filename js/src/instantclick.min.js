"use strict";var InstantClick=function(f,r){function a(t){var e=t.indexOf("#");return e<0?t:t.substr(0,e)}function n(t){for(;t&&"A"!=t.nodeName;)t=t.parentNode;return t}function o(t){var e=r.protocol+"//"+r.host;if(!(e=t.target||t.hasAttribute("download")||0!=t.href.indexOf(e+"/")||-1<t.href.indexOf("#")&&a(t.href)==v)){if(L){t:{do{if(!t.hasAttribute)break;if(t.hasAttribute("data-no-instant"))break;if(t.hasAttribute("data-instant")){t=!0;break t}}while(t=t.parentNode);t=!1}t=!t}else t:{do{if(!t.hasAttribute)break;if(t.hasAttribute("data-instant"))break;if(t.hasAttribute("data-no-instant")){t=!0;break t}}while(t=t.parentNode);t=!1}e=t}return!e}function s(t,e,n,i){for(var r=!1,a=0;a<z[t].length;a++)if("receive"==t){var o=z[t][a](e,n,i);o&&("body"in o&&(n=o.body),"title"in o&&(i=o.title),r=o)}else z[t][a](e,n,i);return r}function d(t,e,n,i){if(f.documentElement.replaceChild(e,f.body),n){if(history.pushState(null,null,n),i=0,e=-1<(e=n.indexOf("#"))&&f.getElementById(n.substr(e+1)))for(;e.offsetParent;)i+=e.offsetTop,e=e.offsetParent;scrollTo(0,i),v=a(n)}else scrollTo(0,i);f.title=x&&f.title==t?t+String.fromCharCode(160):t,m(),W.done(),s("change",!1),(t=f.createEvent("HTMLEvents")).initEvent("instantclick:newpage",!0,!0),dispatchEvent(t)}function l(t){E>+new Date-500||(t=n(t.target))&&o(t)&&y(t.href)}function c(t){E>+new Date-500||(t=n(t.target))&&o(t)&&(t.addEventListener("mouseout",e),A?(g=t.href,T=setTimeout(y,A)):y(t.href))}function h(t){E=+new Date,(t=n(t.target))&&o(t)&&(k?t.removeEventListener("mousedown",l):t.removeEventListener("mouseover",c),y(t.href))}function u(t){var e=n(t.target);!e||!o(e)||1<t.which||t.metaKey||t.ctrlKey||(t.preventDefault(),b(e.href))}function e(){T?(clearTimeout(T),T=!1):N&&!S&&(w.abort(),S=N=!1)}function p(){if(!(w.readyState<4)&&0!=w.status){if(B.ready=+new Date-B.start,w.getResponseHeader("Content-Type").match(/\/(x|ht|xht)ml/)){(t=f.implementation.createHTMLDocument("")).documentElement.innerHTML=w.responseText.replace(/<noscript[\s\S]+<\/noscript>/gi,""),H=t.title,D=t.body,(n=s("receive",O,D,H))&&("body"in n&&(D=n.body),"title"in n&&(H=n.title)),n=a(O),M[n]={body:D,title:H,scrollY:n in M?M[n].scrollY:0};for(var t,e,n=0,i=(t=t.head.children).length-1;0<=i;i--)if((e=t[i]).hasAttribute("data-instant-track")){e=e.getAttribute("href")||e.getAttribute("src")||e.innerHTML;for(var r=I.length-1;0<=r;r--)I[r]==e&&n++}n!=I.length&&(Y=!0)}else Y=!0;S&&(S=!1,b(O))}}function m(t){var e,n,r,a;if(f.body.addEventListener("touchstart",h,!0),k?f.body.addEventListener("mousedown",l,!0):f.body.addEventListener("mouseover",c,!0),f.body.addEventListener("click",u,!0),!t)for(t=f.body.getElementsByTagName("script"),i=0,j=t.length;i<j;i++)(e=t[i]).hasAttribute("data-no-instant")||(n=f.createElement("script"),e.src&&(n.src=e.src),e.innerHTML&&(n.innerHTML=e.innerHTML),r=e.parentNode,a=e.nextSibling,r.removeChild(e),r.insertBefore(n,a))}function y(t){!k&&"display"in B&&+new Date-(B.start+B.display)<100||(T&&(clearTimeout(T),T=!1),t||(t=g),N&&(t==O||S))||(O=t,Y=D=S=!(N=!0),B={start:+new Date},s("fetch"),w.open("GET",t),w.send())}function b(t){"display"in B||(B.display=+new Date-B.start),T||!N?T&&O&&O!=t?r.href=t:(y(t),W.start(0,!0),s("wait"),S=!0):S?r.href=t:Y?r.href=O:D?(M[v].scrollY=pageYOffset,S=N=!1,d(H,D,O)):(W.start(0,!0),s("wait"),S=!0)}var v,g,T,E,w,L,k,A,t=navigator.userAgent,x=-1<t.indexOf(" CriOS/"),C="createTouch"in f,M={},O=!1,H=!1,Y=!1,D=!1,B={},N=!1,S=!1,I=[],z={fetch:[],receive:[],wait:[],change:[]},W=function(){function e(t,e){l=t,f.getElementById(o.id)&&f.body.removeChild(o),o.style.opacity="1",f.getElementById(o.id)&&f.body.removeChild(o),r(),e&&setTimeout(n,0),clearTimeout(c),c=setTimeout(i,500)}function n(){l=10,r()}function i(){98<=(l+=1+2*Math.random())?l=98:c=setTimeout(i,500),r()}function r(){s.style[d]="translate("+l+"%)",f.getElementById(o.id)||f.body.appendChild(o)}function a(){o.style.left=pageXOffset+"px",o.style.width=innerWidth+"px",o.style.top=pageYOffset+"px";var t="orientation"in window&&90==Math.abs(orientation);o.style[d]="scaleY("+innerWidth/screen[t?"height":"width"]*2+")"}var o,s,d,l,c;return{init:function(){(o=f.createElement("div")).id="instantclick",(s=f.createElement("div")).id="instantclick-bar",s.className="instantclick-bar",o.appendChild(s);var t=["Webkit","Moz","O"];if(!((d="transform")in s.style))for(var e=0;e<3;e++)t[e]+"Transform"in s.style&&(d=t[e]+"Transform");var n="transition";if(!(n in s.style))for(e=0;e<3;e++)t[e]+"Transition"in s.style&&(n="-"+t[e].toLowerCase()+"-"+n);(t=f.createElement("style")).innerHTML="#instantclick{position:"+(C?"absolute":"fixed")+";top:0;left:0;width:100%;pointer-events:none;z-index:2147483647;"+n+":opacity .25s .1s}.instantclick-bar{background:#29d;width:100%;margin-left:-100%;height:2px;"+n+":all .25s}",f.head.appendChild(t),C&&(a(),addEventListener("resize",a),addEventListener("scroll",a))},start:e,done:function t(){f.getElementById(o.id)?(clearTimeout(c),l=100,r(),o.style.opacity="0"):(e(100==l?0:l),setTimeout(t,0))}}}(),K="pushState"in history&&(!t.match("Android")||t.match("Chrome/"))&&"file:"!=r.protocol;return{supported:K,init:function(){if(!v)if(K){for(var t=arguments.length-1;0<=t;t--){!0===(e=arguments[t])?L=!0:"mousedown"==e?k=!0:"number"==typeof e&&(A=e)}v=a(r.href),M[v]={body:f.body,title:f.title,scrollY:pageYOffset};var e,n;for(t=(e=f.head.children).length-1;0<=t;t--)(n=e[t]).hasAttribute("data-instant-track")&&(n=n.getAttribute("href")||n.getAttribute("src")||n.innerHTML,I.push(n));(w=new XMLHttpRequest).addEventListener("readystatechange",p),m(!0),W.init(),s("change",!0),addEventListener("popstate",function(){var t=a(r.href);t!=v&&(t in M?(M[v].scrollY=pageYOffset,d(M[v=t].title,M[t].body,!1,M[t].scrollY)):r.href=r.href)})}else s("change",!0)},on:function(t,e){z[t].push(e)}}}(document,location);